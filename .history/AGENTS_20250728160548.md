1. Product Overview
Insight Companion is an Obsidian plugin that helps users automatically generate insightful summaries from collections of their vault notes. It leverages OpenAI’s language models to analyze note content, extracting key themes, people, and actionable items, producing a markdown summary enriched with clickable wiki links.

2. Key User Problems
Manually reviewing large numbers of notes for meaningful insights is time-consuming and error-prone.

Existing plugins/settings offer limited, rigid date filtering without interactive flexibility.

API token limits cause failures if too many notes are sent without chunking.

Current manual workflows lack transparency about cost and data volume before API calls.

3. Core Product Goals
Provide a flexible, interactive date picker on command invocation to select any date range for note summarization.

Show users a confirmation dialog before summarization, displaying the number of notes and an approximate token count to be sent.

Efficiently chunk large note sets to avoid exceeding API limits and aggregate summaries smoothly.

Generate clean markdown output without extraneous code fences so Obsidian renders links and formatting naturally.

Store only essential configuration (OpenAI API key, output folder, provider choice) in plugin settings—no static date filters.

Offer robust error handling and clear user notifications throughout the workflow.

Maintain comprehensive test coverage including UI components, token estimation, API calls, and orchestration.

4. User Workflow
User runs “Generate Insight Summary” command from command palette.

Plugin shows an interactive date picker to select start and end dates.

Plugin calculates filtered note count and token estimate, shows confirmation dialog.

User confirms or cancels; on confirm:

Plugin chunks notes (if necessary) and calls OpenAI API per batch.

Aggregates partial summaries into a final summary markdown.

Saves the summary as a markdown note with a header showing date range, note count, and token usage.

User receives a success notification with file location or clear error if something fails.

5. Technical & Design Requirements
Plugin Settings: Only OpenAI API key, output folder, and provider selection (default OpenAI).

Date Picker: Accessible modal dialog triggered on summary command, with presets and custom range.

Token Estimation: Based on rough character-to-token conversion (e.g., 4 chars/token), including prompt overhead.

Chunking Strategy: Batch size configurable or hardcoded (e.g., 10 notes per chunk), multi-step summarization.

Output Formatting: No triple backticks wrapping entire output; keep markdown clean for Obsidian wiki links.

Testing: Unit, integration, UI tests with full coverage and proper mocking.

Security: No API keys in code or commits; .gitignore configured.

Error Handling: User notifications for API errors, empty note sets, missing keys, file system errors.

Performance: Efficient filtering, minimal memory footprint, smooth UI transitions.

6. Non-Goals
Not implementing local LLM support initially.

No automatic scheduled summaries (could be future work).

No extensive UI redesign beyond essential modals and notifications.

No support for multiple vaults simultaneously.

7. Success Metrics
Successful generation of markdown insight summaries with clickable wiki links.

User adoption of interactive date picker vs. static settings.

Reduction in API errors due to token overflows.

Positive user feedback on clarity of confirmation dialog and error messages.